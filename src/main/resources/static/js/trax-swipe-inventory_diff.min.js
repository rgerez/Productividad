function sol_code_action(element) {
    var element_id = element.attr('element-id');
    var code = $("input[element-id=" + element_id + "]").val();
    var type = $(".swipe-row[element-id|='" + element_id + "']").attr('element-type');
    if (code == "") {
        $(".swipe-row[element-id|='" + element_id + "']").find('.swipe-indicator')
            .removeClass().addClass("swipe-indicator swipe-indicator2");
        return;
    }
    $.ajax({
        url: "/api/putSolutionCode.json",
        type: "POST",
        dataType: 'json',
        data: {
            'id': element_id,
            'code': code,
            'type': type
        },
        success: function (data) {
            $(".swipe-row[element-id|='" + element_id + "']").find('.swipe-indicator')
                .removeClass().addClass("swipe-indicator swipe-indicator1");
            $("a[element-id|='" + element_id + "']").removeClass().addClass("ui-btn btn-code ui-btn-indicator-1");
            var close_collapsed = $("#" + element_id).closest('.ui-collapsible');
            var counter_indicator = close_collapsed[0].querySelectorAll('.swipe-indicator1, .swipe-indicator0');
            var first = close_collapsed[0].querySelector('.updated_number');
            first.innerHTML = "" + counter_indicator.length;
        }
    });
}

function no_sol_action(element) {
    var element_id = element.attr('element-id')
    var type = $(".swipe-row[element-id|='" + element_id + "']").attr('element-type');
    $.ajax({
        url: "/api/putNoSolution.json",
        type: "POST",
        dataType: 'json',
        data: {
            'id': element_id,
            'no-sol-val': element.attr('nosolution-val'),
            'type': type
        },
        success: function (data) {
            $('.ul-link-nosol').removeClass('selected');
            $(".swipe-row[element-id|='" + element_id + "']").attr('no-sol-id', element.attr('nosolution-val'));
            element.addClass('selected');
            $(".swipe-row[element-id|='" + element_id + "']").find('.swipe-indicator')
                .removeClass().addClass("swipe-indicator swipe-indicator0");
            var close_collapsed = $("#" + element_id).closest('.ui-collapsible');
            var counter_indicator = close_collapsed[0].querySelectorAll('.swipe-indicator1, .swipe-indicator0');
            var first = close_collapsed[0].querySelector('.updated_number');
            first.innerHTML = "" + counter_indicator.length;
        }
    });
};


$(document).on("swiperight", ".swipe-row .swipe-element", function (e) {
    $(this).css({
        transform: "translateX(+100px)"
    }).one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd", function () {
        $(this).css({
            transform: "translateX(0)"
        });
    });

    var element_id = $(this).attr('element-id');
    var type = $(this).attr('element-type');
    swipe_action(element_id, "R", type);

});

$(document).on("swipeleft", ".swipe-row .swipe-element", function (e) {
    $(this).css({
        transform: "translateX(-100px)"
    }).one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd", function () {
        $(this).css({
            transform: "translateX(0)"
        });
    });

    var element_id = $(this).attr('element-id');
    var type = $(this).attr('element-type');

    swipe_action(element_id, "L", type);
});

$(document).on("dblclick", ".swipe-row .swipe-element", function (e) {


    var element_id = $(this).attr('element-id');
    var type = $(this).attr('element-type');
    window.location.href = 'sku-alerts/' + element_id;
});

function swipe_action(element_id, direction, type) {
    $('.causes').slideUp(function () {
        $(this).remove();
    });
    $('.positive').slideUp(function () {
        $(this).remove();
    });

    if (direction === "L") {
        var no_sol_id = $(".swipe-row[element-id|='" + element_id + "']").attr('no-sol-id');
        var no_solution = $("#no-solution").html();
        $(".swipe-row[element-id|='" + element_id + "']").after('<div class="causes" element-id="' + element_id + '">');
        $(".causes[element-id|='" + element_id + "']").html(no_solution).hide();
        $(".causes[element-id|='" + element_id + "']").slideDown();
        $(".ul-link-nosol").each(function (index) {
            if (no_sol_id == $(this).attr("nosolution-val")) {
                $(this).addClass("selected");
            }
            else {
                $(this).removeClass("selected");
            }
            $(this).attr("element-id", element_id);
        });
    }
    if (direction === "R") {
        var solution = $("#positive-inventory-diff").html();

        $(".swipe-row[element-id|='" + element_id + "']").after('<div class="positive" element-id="' + element_id + '">');
        $(".positive[element-id|='" + element_id + "']").html(solution).hide();
        $(".positive[element-id|='" + element_id + "']").slideDown();
        $(".positive[element-id|='" + element_id + "']").find('.btn-code').attr("element-id", element_id);
        var tmpCode = $(".swipe-row[element-id|='" + element_id + "']").attr('sol_code');
        $(".positive[element-id|='" + element_id + "']").find('.input-code').attr("element-id", element_id);
        $(".positive[element-id|='" + element_id + "']").find('.input-code').val(tmpCode);


    }

}